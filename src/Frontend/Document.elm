module Frontend.Document exposing (changeLanguage)

import Effect.Command exposing (Command, FrontendOnly)
import Effect.Lamdera
import Frontend.Update
import Types


changeLanguage : Types.FrontendModel -> ( Types.FrontendModel, Command FrontendOnly Types.ToBackend Types.FrontendMsg )
changeLanguage model =
    case model.currentDocument of
        Nothing ->
            ( model, Effect.Command.none )

        Just doc ->
            let
                newDocument =
                    { doc | language = model.language }
            in
            ( model
            , Effect.Lamdera.sendToBackend (Types.SaveDocument model.currentUser newDocument)
            )
                |> (\( m, c ) -> ( Frontend.Update.postProcessDocument newDocument m, c ))
